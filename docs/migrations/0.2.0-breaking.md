# 0.2.0 Breaking Migration

## 概览

`0.2.0` 是破坏式重构版本：

- 外部子命令入口被移除
- 配置结构从旧模型迁移到 `source/behavior/outputs`
- 同步动作改为 daemon 内部机制 + `$sync`

## 配置迁移

旧配置块：

- `project.ignore_dirs`
- `[rttd.server]`
- `[rttd.foxglove]`
- `rttd.source.preferred_backend`
- `rttd.source.backend.jlink.rtt_telnet_port`

新配置块：

- `.rttdignore`（唯一扫描过滤入口）
- `[rttd.source]`
- `[rttd.source.backend]`（`type` 为唯一后端选择入口）
- `[rttd.behavior]`
- `[rttd.outputs.jsonl]`
- `[rttd.outputs.foxglove]`

## 运行迁移

新入口：

```bash
cargo run -p rttd -- --config <path/to/rat.toml>
```

运行控制迁移到命令台：

- source 切换：`$source list` / `$source use <index>`
- 同步触发：`$sync`
- 输出控制：`$foxglove on|off`、`$jsonl on|off [path]`

## 常见失败与处理

- 配置加载失败：检查是否仍使用旧配置块
- generated 文件问题：进入 daemon 后执行 `$sync`
- 指纹不一致：重新同步并重编译固件
